(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{108:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i});var a=n(62),r=n(63),o=function(){function e(){Object(a.a)(this,e)}return Object(r.a)(e,null,[{key:"toMinutesSinceMidnight",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(typeof e){case"number":t=e;break;case"string":if(t=parseInt(e),isNaN(t))return void console.warn("Unexpected input: ",e);break;case"object":var a=parseInt(e.h);12===a&&"pm"in e&&(a-=12),t=60*a+parseInt(e.m),e.pm&&(t+=720),e.s&&(t+=e.s/60);break;default:return void console.warn("Unexpected input: ",e)}return n&&this.isBiggerThan(e,0,!0)&&this.isBiggerThan(300,e,!0)&&(t+=1440),t}},{key:"toTimeObject",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Number.isInteger(e)||(e=Math.round(e));var n=!1;if(t){for(;e>=1440;)e-=1440;e>=720&&(n=!0,e-=720)}var a=e%60,r=(e-a)/60;return(isNaN(r)||isNaN(a))&&console.warn("NaN result: ",{h:r,m:a,pm:n}),t?{h:r,m:a,pm:n}:{h:r,m:a}}},{key:"addToMinutes",value:function(){for(var e=Array.isArray(arguments[0])?arguments[0]:arguments,t=0,n=0;n<e.length;n++)t+=this.toMinutesSinceMidnight(e[n]);return Number.isInteger(t)?t:Math.round(t)}},{key:"add",value:function(){return this.toTimeObject(this.addToMinutes.apply(this,arguments))}},{key:"subtractToMinutes",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=this.toMinutesSinceMidnight(e,n)-this.toMinutesSinceMidnight(t,n);return Number.isInteger(a)?a:Math.round(a)}},{key:"subtract",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=this.subtractToMinutes(e,t,n);return this.toTimeObject(a,!1)}},{key:"makeString",value:function(e){var t,n,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if("number"===typeof e&&(e=this.toTimeObject(e,a)),o&&(a=!1),"string"===typeof e.m&&(e.m=parseInt(e.m)),e.s&&e.s>29&&(e.m=parseInt(e.m)+1),n=e.m>=10?e.m:"0"+e.m,t=(a||r)&&0===e.h?12:parseInt(e.h),o&&e.pm&&(t+=12),!isNaN(n)){var i=t+":"+n;if("undefined"!==typeof e.pm&&a)i+=" "+(e.pm?"PM":"AM");return i}console.warn("Wrong input to makeString: ",e)}},{key:"round",value:function(e,t){var n=this.toMinutesSinceMidnight(e);return n=Math.round(n/t)*t,this.toTimeObject(n)}},{key:"isBiggerThan",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=this.subtractToMinutes(e,t,a);return n?r>=0:r>0}},{key:"areIdentical",value:function(){for(var e,t=0;t<arguments.length;t++){var n=arguments[t];if(isNaN(n.h)&&(n.h=n.h.toString()),isNaN(n.m)&&(n.m=n.m.toString()),"string"===typeof n.h&&(n.h=parseInt(n.h)),"string"===typeof n.m&&(n.m=parseInt(n.m)),e){if(n.h!==e.h||n.m!==e.m||n.pm!==e.pm)return!1;e=n}else e=n}return!0}},{key:"suggestStartTime",value:function(e,t,n){var a=this.add(e,t*n.bufferTimePercentage);return this.round(a,n.roundTo)}},{key:"average",value:function(){var e=this.addToMinutes.apply(this,arguments),t=Math.round(e/arguments.length);return this.toTimeObject(t)}},{key:"makeFullLengthDurationString",value:function(e){var t=parseInt(e.h),n=parseInt(e.m);e.pm&&(t+=12);var a="";return t&&(a+=t+" hour"),t>1&&(a+="s"),t&&n&&(a+=" and "),n&&(a+=n+" minute"),n>1&&(a+="s"),t||n||(a="0 minutes"),a}}]),e}();function i(e,t,n,a){if((n=JSON.parse(JSON.stringify(n))).length){for(var r={projects:[],breaks:[]},i=0;i<e.length;i++)r.projects[i]=o.average(e[i].plannedTime.start,e[i].plannedTime.end);for(var s=0;s<n.length;s++)r.breaks[s]=o.average(n[s].startTime,n[s].endTime)}for(var c=0;c<e.length;c++){e[c].plannedTime||(e[c].plannedTime={}),e[c].plannedTime.start=0!==c?o.suggestStartTime(e[c-1].plannedTime.end,e[c-1].estimatedDuration,t):a,e[c].plannedTime.end=o.add(e[c].plannedTime.start,e[c].estimatedDuration);for(var d=0;d<n.length;d++){var l=0===c?e[c].plannedTime.start:e[c-1].plannedTime.end;if(o.isBiggerThan(e[c].plannedTime.end,n[d].startTime,!0,!0)&&o.isBiggerThan(n[d].startTime,l,!0,!0)){var u=o.isBiggerThan(r.projects[c],r.breaks[d],!0,!0),f=o.subtractToMinutes(n[d].endTime,n[d].startTime,!0);u?(n[d].startTime=0===c?e[c].plannedTime.start:e[c-1].plannedTime.end,n[d].endTime=o.add(n[d].startTime,f),e[c].plannedTime.start=0===c?n[d].endTime:o.suggestStartTime(n[d].endTime,e[c-1].estimatedDuration,t),e[c].plannedTime.end=o.add(e[c].plannedTime.start,e[c].estimatedDuration)):(n[d].startTime=e[c].plannedTime.end,n[d].endTime=o.add(n[d].startTime,f))}}}return e}},131:function(e,t,n){"use strict";var a=n(1),r=n.n(a),o=n(297);t.a=function(e){return r.a.createElement(o.a,{singleColor:"#039be5"})}},179:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return i});var a=n(1),r=n.n(a),o=r.a.createContext({}),i=r.a.createContext({})},191:function(e,t,n){"use strict";function a(e,t){for(var n,a=!1;!a;){n=Math.floor(Math.random()*Math.pow(10,8)),a=!0;for(var r=0;r<e.length;r++)if(e[r].id===n){a=!1;break}if(a){var o=["lastModified",t,n,"id"].join("_");isNaN(localStorage[o])||(a=!1)}}return n}n.d(t,"a",function(){return a})},303:function(e,t,n){e.exports=n(766)},54:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return r});var a={timeFormat24H:!1,bufferTimePercentage:.2,showResetButtonAfter:16,defaultColors:["#4BFFD1","#39FF00","#E8A60C","#FF4848","#290CE8"],updateTimesAfterDrag:!0,updateTimesAfterEdit:!0,updateTimesAfterDelete:!0,roundTo:5,changeModeOnTab:!1,detectBreaksAutomatically:!0,adjustDurationOnPause:!0,offerToAdjustDurationOnDone:!0,darkTheme:!1},r={projects:[],breaks:[],defaultProjects:[],settings:a,startTime:{h:2,m:"00",pm:!0},endTime:{h:9,m:"00",pm:!0},mode:"planning",defaultColorIndex:0,defaultColorIndexDefaultProjects:0,productivityPercentages:{},useDefaultProjects:!0,lastReset:void 0,lastModified:{},realEndTime:void 0}},630:function(e,t,n){},665:function(e,t){},668:function(e,t,n){},766:function(e,t,n){"use strict";n.r(t);n(304);var a=n(1),r=n.n(a),o=n(67),i=n.n(o),s=(n(630),n(62)),c=n(63),d=n(80),l=n(78),u=n(79),f=n(1227),p=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(d.a)(this,Object(l.a)(t).call(this,e))).state={hasError:!1,error:null},f.a({dsn:"https://4ff9b4a95e3d4694b3191e745dc529ff@sentry.io/1480676"}),n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return this.state.hasError?r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement("h3",{style:{color:"red"}},"Oops, something went wrong"),"Please, try ",r.a.createElement("b",null,"reloading")," the page",r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),"If you keep seeing this message, ",r.a.createElement("b",null,"send us a bug report"," ",r.a.createElement("a",{className:"noStyling",href:"https://goo.gl/forms/jdesExEMegbkLPjp2",target:"_blank",rel:"noopener noreferrer"},"here")),r.a.createElement("br",null),"While doing that, make sure you ",r.a.createElement("b",null,"tell us what you were trying to do"),". This helps us a lot when fixing issues.",r.a.createElement("br",null),this.state.error&&r.a.createElement(r.a.Fragment,null,"Please also ",r.a.createElement("b",null,"include the following information")," in the bug report:",r.a.createElement("p",null,r.a.createElement("code",null,this.state.error.toString())))):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0,error:e}}}]),t}(a.Component),h=n(41),m=n(292),g=n(25),b=n(109),v=n(184),y=n(188),j=n(131),T=n(54),k=n(179),S=r.a.lazy(function(){return Promise.all([n.e(2),n.e(4),n.e(5),n.e(30),n.e(8)]).then(n.bind(null,1228))}),M=r.a.lazy(function(){return Promise.all([n.e(0),n.e(2),n.e(5),n.e(9)]).then(n.bind(null,1230))}),O=r.a.lazy(function(){return n.e(10).then(n.bind(null,1217))}),E=r.a.lazy(function(){return Promise.all([n.e(2),n.e(11)]).then(n.bind(null,1218))}),w=r.a.lazy(function(){return n.e(12).then(n.bind(null,1219))}),_=r.a.lazy(function(){return Promise.all([n.e(0),n.e(2),n.e(3),n.e(4),n.e(13)]).then(n.bind(null,1231))}),D=r.a.lazy(function(){return n.e(14).then(n.bind(null,1220))}),I=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(d.a)(this,Object(l.a)(t).call(this,e))).AppWithProps=function(e){return r.a.createElement(S,Object.assign({data:n.props.data,connect:n.props.connect,changeMode:n.changeMode,update:n.props.update,disconnect:n.props.disconnect,loggedIn:n.props.loggedIn,disconnected:n.props.disconnected,currentTime:n.state.currentTime,showErrors:n.state.showErrors,changeRouterShowErrors:n.changeShowErrors,onCurrentTimeChange:function(e){n.setState({currentTime:e})}},e))},n.SettingsWithProps=function(e){return r.a.createElement(M,Object.assign({settings:Object.assign({},n.props.data.settings),defaultSettings:T.b,update:n.props.update},e))},n.SettingsDefaultColorsWithProps=function(e){return r.a.createElement(E,Object.assign({settings:Object.assign({},n.props.data.settings),save:function(e){n.props.update({settings:Object(g.a)({},n.props.data.settings,{defaultColors:e})})}},e))},n.changeMode=function(e){if("working"===e){if(""===n.props.data.endTime.h||""===n.props.data.endTime.m)return void n.changeShowErrors("endTime",!0);if(!n.props.data.projects.length)return void n.changeShowErrors("noProjects",!0)}n.props.update({mode:e})},n.changeShowErrors=function(e,t){n.setState({showErrors:Object(g.a)({},n.state.showErrors,Object(b.a)({},e,t))})},n.state={width:window.innerWidth,currentTime:{h:0,m:0,pm:!0,defaultVal:!0},showErrors:{}},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){var e=this;window.addEventListener("resize",function(){e.setState({width:window.innerWidth})})}},{key:"render",value:function(){var e=this,t=this.state.width<660;return r.a.createElement(v.BrowserRouter,null,r.a.createElement(r.a.Suspense,{fallback:r.a.createElement(j.a,null)},t?r.a.createElement(_,{data:this.props.data,connect:this.props.connect,changeMode:this.changeMode,disconnect:this.props.disconnect,loggedIn:this.props.loggedIn,currentTime:this.state.currentTime,onCurrentTimeChange:function(t){e.setState({currentTime:t})},update:localStorage.devUnlocked?this.props.update:{}}):r.a.createElement(y.g,null,r.a.createElement(y.d,{path:"/(|add|edit|breaks|defaultProjects)",exact:!0}),r.a.createElement(y.d,{component:w}))),r.a.createElement(k.a.Provider,{value:t},r.a.createElement(r.a.Suspense,{fallback:r.a.createElement(j.a,null)},r.a.createElement(y.g,null,r.a.createElement(y.d,{path:"/settings/defaultColors/",render:this.SettingsDefaultColorsWithProps}),r.a.createElement(y.d,{path:"/settings/",render:this.SettingsWithProps}),r.a.createElement(y.d,{path:"/about/",component:O}),r.a.createElement(y.d,{path:"/robots.txt",target:"_self"}),r.a.createElement(y.d,{path:"/(|add|edit|breaks|defaultProjects)",exact:!0,render:this.AppWithProps}),r.a.createElement(y.d,{render:function(){return r.a.createElement(y.c,{to:"/"})}})))),r.a.createElement(r.a.Suspense,{fallback:r.a.createElement(j.a,null)},t?r.a.createElement(y.d,{path:"/about/",component:D}):r.a.createElement(D,null)))}}]),t}(a.Component),N=n(108),P=n(269),C=n.n(P),A=n(177),x=n.n(A),W=n(178),F=n.n(W),U=n(302),R=n.n(U),L=n(183),B=n.n(L),z=n(300),J=n(90),q=n(295),H=n.n(q),V=n(191),K=n(291);function $(e,t){for(var n=JSON.parse(JSON.stringify(e)),a=Object.entries(t),r=0;r<a.length;r++){var o=a[r],i=Object(h.a)(o,2),s=i[0],c=i[1];if("object"===typeof c&&"function"!==typeof c.getTime){var d=e[s];d||(d={}),n[s]=$(d,c)}else n[s]=c}return n}for(var G={type:"number"},Q={type:"number",required:!0},X={type:"string",required:!0},Y={type:"boolean",required:!0},Z={type:"object",properties:{h:Q,m:Q,pm:Y,s:G}},ee=Object(g.a)({},Z,{required:!0}),te={type:"string",isDate:!0},ne=function(e){return{type:"object",isArray:!0,elements:e}},ae=function(e){return{type:"object",properties:e}},re={id:Q,name:X,color:X,estimatedDuration:Q,state:X,order:G,plannedTime:{type:"object",properties:{start:ee,end:ee}}},oe={},ie=Object.entries(T.b),se=0;se<ie.length;se++){var ce=ie[se],de=Object(h.a)(ce,2),le=de[0],ue=de[1],fe=typeof ue;"object"===fe?Array.isArray(ue)?oe[le]=ne({type:typeof ue[0],required:!0}):console.warn("Unhandled scenraio, settings contains an object that isn't an array"):oe[le]={type:fe,required:!0}}for(var pe={},he=["startTime","endTime","mode","defaultColorIndex","defaultColorIndexDefaultProjects","lastReset","useDefaultProjects"],me=Object.keys(re),ge={projects:Object(K.a)(me).concat(["startedWorkingOnIt","progress"]),breaks:["id","name","startTime","endTime","autodetected"],defaultProjects:Object(K.a)(me).concat(["days"]),settings:Object.keys(T.b)},be=0;be<he.length;be++){pe[he[be]]=te}for(var ve=Object.entries(ge),ye=0;ye<ve.length;ye++){var je=ve[ye],Te=Object(h.a)(je,2),ke=Te[0],Se=Te[1],Me={},Oe=!0,Ee=!1,we=void 0;try{for(var _e,De=Se[Symbol.iterator]();!(Oe=(_e=De.next()).done);Oe=!0){var Ie=_e.value;"id"===Ie?Me.id=Object(g.a)({},te,{required:!0}):Me[Ie]=te}}catch(Be){Ee=!0,we=Be}finally{try{Oe||null==De.return||De.return()}finally{if(Ee)throw we}}pe[ke]=ae("settings"===ke?Me:{__any__:ae(Me)})}var Ne={projects:ne(ae(Object(g.a)({},re,{startedWorkingOnIt:Z,progress:G}))),breaks:ne(ae({id:Q,name:X,startTime:ee,endTime:ee,autodetected:{type:"boolean"}})),defaultProjects:ne(ae(Object(g.a)({},re,{days:ne(Y)}))),settings:ae(oe),startTime:ee,endTime:ee,mode:X,defaultColorIndex:Q,defaultColorIndexDefaultProjects:Q,lastReset:X,useDefaultProjects:Y,productivityPercentages:ae({__any__:G}),realEndTime:te,lastModified:ae(pe)};function Pe(e){"string"===typeof e&&console.warn("Keys must be an array!");var t="Incorrect property detected in data: ".concat(e.join(".")," should not be defined");try{var n=e.reduce(function(e,t){return e[t]},Ne)}catch(a){console.warn(t),console.warn(a)}return n||console.warn(t),n}function Ce(e,t){var n=Pe(e);if(n){var a=n.type,r=typeof t;if(n.isDate){if("string"===r&&!isNaN(new Date(t).getTime())||"object"===r&&!isNaN(t.getTime()))return t;if("undefined"===r)return;console.warn("Incorrect type or invalid date detected: ".concat(e.join(".")," is '").concat(t,"' (of type ").concat(r,") which isn't a valid date"))}else{if(a===r||"number"===a&&"string"===r&&!isNaN(parseFloat(t))||"string"===a&&n.isDate&&"object"===r&&t instanceof Date)return t;"undefined"!==r&&console.warn("Incorrect type detected in data: ".concat(e.join(".")," is '").concat(t,"' which is of type ").concat(r,", should be of type ").concat(a))}}}function Ae(e,t){var n,a=Pe(e);if(a){if(a.isArray){if(n=[],!Array.isArray(t))return;var r=!0,o=!1,i=void 0;try{for(var s,c=t[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var d=s.value;"object"===typeof d?n.push(Ae(Object(K.a)(e).concat(["elements"]),d)):n.push(Ce(Object(K.a)(e).concat(["elements"]),d))}}catch(Be){o=!0,i=Be}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}}else{n={};for(var l=Object.entries(t),u=0;u<l.length;u++){var f=l[u],p=Object(h.a)(f,2),m=p[0],g=p[1],b=void 0,v=void 0;if(a.properties[m])b=a.properties[m].type,v=m;else{if(!a.properties.__any__){console.warn("Incorrect property in data: ".concat(e.join("."),".").concat(m," should not be defined "));continue}b=a.properties.__any__.type,v="__any__"}"object"===b?(n[m]=Ae(Object(K.a)(e).concat(["properties",v]),g),n[m]&&n[m].__lastModifiedSysNote&&(n.__lastModifiedSysNote||(n.__lastModifiedSysNote={}),n.__lastModifiedSysNote[m]=n[m].__lastModifiedSysNote,delete n[m].__lastModifiedSysNote)):n[m]=Ce(Object(K.a)(e).concat(["properties",v]),g)}for(var y=Object.entries(a.properties),j=0;j<y.length;j++){var k=y[j],S=Object(h.a)(k,2),M=S[0];if(S[1].required&&"undefined"===typeof t[M]){console.warn("Property missing in data: ".concat(e.join("."),".").concat(M," is not defined"));var O=void 0;1===e.length&&"settings"===e[0]&&(O=T.b[M]),"undefined"!==typeof O&&(console.log("".concat(e.join("."),".").concat(M," automatically set to ").concat(O)),n[M]=O,n.__lastModifiedSysNote||(n.__lastModifiedSysNote={}),n.__lastModifiedSysNote[M]=!0)}}}return n}}function xe(e){for(var t={},n=Object.entries(e),a=0;a<n.length;a++){var r=n[a],o=Object(h.a)(r,2),i=o[0],s=o[1];Ne[i]?"object"===Ne[i].type?(t[i]=Ae([i],s),t[i].__lastModifiedSysNote&&(t.__lastModifiedSysNote||(t.__lastModifiedSysNote={}),t.__lastModifiedSysNote[i]=t[i].__lastModifiedSysNote,delete t[i].__lastModifiedSysNote)):t[i]=Ce([i],s):console.warn("Incorrect key in data: ".concat(i))}if(t.__lastModifiedSysNote){var c=function e(t){var n={};return Object.entries(t).forEach(function(t){var a=Object(h.a)(t,2),r=a[0],o=a[1];n[r]="object"===typeof o?e(o):new Date}),n}(t.__lastModifiedSysNote);delete t.__lastModifiedSysNote,t.lastModified?t.lastModified=$(t.lastModified,c):t.lastModified=c}return t}n(668);var We=Object(J.createMuiTheme)({palette:{primary:{main:"#039be5"},secondary:H.a},typography:{useNextVariants:!0}}),Fe=Object(J.createMuiTheme)({palette:{primary:{main:"#039be5"},secondary:H.a,type:"dark"},typography:{useNextVariants:!0}}),Ue=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(d.a)(this,Object(l.a)(t).call(this,e))).connect=function(e){if(n.io.disconnected)n.setState({temp:Object(g.a)({},n.state.temp,{showDisconnectedError:!0})});else{var t=n.state,a=(t.accessToken,t.temp,Object(m.a)(t,["accessToken","temp"]));n.idToken=e,n.io.emit("connectInit",{type:"OAuth",idToken:e,localData:a})}},n.disconnect=function(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||window.confirm("Are you sure you want to sign out?")){if(n.io.disconnected)return void n.setState({temp:Object(g.a)({},n.state.temp,{showDisconnectedError:!0})});n.io.emit("disconnectU",{accessToken:localStorage.accessToken})}},n.update=function(e,t){if(e.projects&&!e.projects.length&&n.state.projects.length){if(e.useDefaultProjects||n.state.useDefaultProjects){var a=(new Date).getDay();--a<0&&(a=6),e.projects=[],n.state.defaultProjects.forEach(function(t){var n=t.days,r=Object(m.a)(t,["days"]);n&&!n[a]||e.projects.push(r)});var r=e.settings||n.state.settings,o=N.a.add(60*(new Date).getHours()+(new Date).getMinutes(),10);o=N.a.round(o,r.roundTo),e.projects=Object(N.b)(e.projects,r,[],o),e.projects.forEach(function(t){t.id=Object(V.a)(e.projects,"projects")}),e.startTime=o;var i=!0}else e.projects=[];e.breaks=[],e.lastReset=(new Date).toISOString(),e.realEndTime=void 0,e.lastModified||(e.lastModified={}),e.lastModified.projects={},e.lastModified.breaks={},n.deleteObjectsLocalStorage("lastModified_projects_"),n.deleteObjectsLocalStorage("lastModified_breaks_")}e=xe(e);for(var s=["projects","defaultProjects"],c=0;c<s.length;c++){var d=s[c];e[d]&&e[d].forEach(function(e,t){e.order=t})}e.realEndTime&&(e.realEndTime=e.realEndTime.toISOString());var l={};Object.keys(e).forEach(function(a){switch(a){case"projects":l.projects=n.setMultipleLastModified(e.projects,t&&!i?t.projects:void 0,"projects");break;case"breaks":l.breaks=n.setMultipleLastModified(e.breaks,t?t.breaks:void 0,"breaks");break;case"defaultProjects":l.defaultProjects=n.setMultipleLastModified(e.defaultProjects,t?t.defaultProjects:void 0,"defaultProjects");break;case"settings":l.settings=n.state.lastModified&&n.state.lastModified.settings?n.state.lastModified.settings:{},Object.keys(e.settings).forEach(function(t){e.settings[t]!==n.state.settings[t]&&(l.settings[t]=new Date,localStorage["lastModified_settings_"+t]=l.settings[t].toISOString())});break;case"lastReset":case"realEndTime":break;default:l[a]=new Date,localStorage["lastModified_"+a]=l[a].toISOString()}}),e.lastModified=$(n.state.lastModified,l),n.setState(e);for(var u=Object.entries(e),f=0;f<u.length;f++){var p=u[f],b=Object(h.a)(p,2),v=b[0],y=b[1];"lastModified"!==v&&("undefined"!==typeof y?localStorage[v]="object"===typeof y&&"lastReset"!==v?JSON.stringify(y):y:delete localStorage[v])}if(n.state.accessToken)if(n.io.disconnected)n.setState({temp:Object(g.a)({},n.state.temp,{updatedWhileDisconnected:!0})});else{e.lastReset||(e.lastReset=n.state.lastReset);for(var j={},T=Object.keys(l),k=0;k<T.length;k++){var S=T[k];j[S]=e.lastModified[S]}e.lastModified=j,n.io.emit("update",{accessToken:n.state.accessToken,data:e})}},n.closeSnackbar=function(){n.setState({temp:Object(g.a)({},n.state.temp,{showDisconnectedError:!1})})},n.setLastModified=function(e,t,a,r){if(!e){r={id:new Date};var o=["lastModified",a,t,"id"].join("_");return localStorage[o]=r.id.toISOString(),n.deleteObjectsLocalStorage(["lastModified",a,t,""].join("_"),o),r}r||(r={});var i=n.state[a].findIndex(function(e){return e.id===t});return Object.keys(e).forEach(function(o){if(!n.state[a][i]||("object"===typeof e[o]?!function e(t,n){if(!n)return!1;var a;a=Array.isArray(t)?t.keys():Object.keys(t);var r=!0,o=!1,i=void 0;try{for(var s,c=a[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var d=s.value;if("object"===typeof t[d]){if(!e(t[d],n[d]))return!1}else if(t[d]!==n[d])return!1}}catch(Be){o=!0,i=Be}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return!0}(e[o],n.state[a][i][o]):e[o]!==n.state[a][i][o])){r[o]=new Date;var s=["lastModified",a,t,o].join("_");localStorage[s]=r[o].toISOString()}}),r},n.setMultipleLastModified=function(e,t,a){var r=n.state.lastModified[a];return r||(r={}),t?("object"!==typeof t&&(t=[t]),t.forEach(function(t){var o=e.findIndex(function(e){return e.id===parseInt(t)}),i=e[o];r[t]=n.setLastModified(i,t,a,r[t])})):e.forEach(function(e,t){var o=e.id;r[o]=n.setLastModified(e,o,a,r[o])}),r},n.deleteObjectsLocalStorage=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=Object.keys(localStorage),a=[];n.forEach(function(n){n.startsWith(e)&&n!==t&&a.push(n)}),a.forEach(function(e){localStorage.removeItem(e)})},n.handleUpdateFromServer=function(e){n.setState(Object(g.a)({},e,{lastModified:Object(g.a)({},n.state.lastModified,e.lastModified)})),Object.keys(e).forEach(function(t){"lastModified"===t?Object.keys(e.lastModified).forEach(function(t){if("projects"===t||"breaks"===t||"defaultProjects"===t)for(var n=Object.keys(e.lastModified[t]),a=function(){var a=n[r];if(!e.lastModified[t][a]||"object"!==typeof e.lastModified[t][a])return"continue";Object.keys(e.lastModified[t][a]).forEach(function(n){var r=["lastModified",t,a,n].join("_"),o=e.lastModified[t][a][n];"string"!==typeof o&&(o=o.toISOString()),localStorage[r]=o})},r=0;r<n.length;r++)a();else if("settings"===t)for(var o=Object.keys(e.lastModified.settings),i=0;i<o.length;i++){var s=o[i],c=e.lastModified.settings[s];if(c){var d="lastModified_settings_"+s;"string"!==typeof c&&(c=c.toISOString()),localStorage[d]=c}}else{var l=e.lastModified[t];l&&("string"!==typeof l&&(l=l.toISOString()),localStorage["lastModified_"+t]=l)}}):"object"===typeof e[t]?localStorage[t]=JSON.stringify(e[t]):localStorage[t]=e[t]})},n.checkForUpdates=function(){n.state.accessToken&&!n.io.disconnected&&n.io.emit("checkForUpdates",{accessToken:n.state.accessToken})},n.state={projects:[],settings:{},lastModified:{},temp:{}},n.io=z.connect("https://mind-your-time-server.herokuapp.com"),setTimeout(function(){if(n.io.disconnected){console.warn("Can't connect to server");var e=n.state.temp;e.disconnected=!0,n.state.accessToken&&(e.showDisconnectedError=!0),n.setState({temp:e})}},500),n.io.on("connect",function(e){if(!n.state.temp.successfulConnectInit&&n.state.temp.disconnected&&n.state.accessToken){var t;if(!n.state.temp.successfulConnectInit||n.state.temp.updatedWhileDisconnected){var a=n.state;a.accessToken,a.temp;t=Object(m.a)(a,["accessToken","temp"])}else t={};n.io.emit("connectInit",{type:"accessToken",accessToken:n.state.accessToken,localData:t})}var r=n.state.temp;r.disconnected=!1,r.showDisconnectedError=!1,clearTimeout(r.showDisconnectedErrorTimeout),n.setState({temp:r})}),n.io.on("disconnect",function(e){var t=n.state.temp;t.disconnected=!0,n.state.accessToken&&(t.showDisconnectedErrorTimeout=setTimeout(function(){n.setState({temp:Object(g.a)({},n.state.temp,{showDisconnectedError:!0})})},1500)),n.setState({temp:t})}),n.io.on("success",function(e){"connectInsert"!==e.type&&"connectUpdate"!==e.type||(localStorage.accessToken=e.accessToken,n.setState({accessToken:e.accessToken,temp:Object(g.a)({},n.state.temp,{successfulConnectInit:!0})})),"disconnect"===e.type&&(delete localStorage.accessToken,n.setState({accessToken:void 0}))}),n.io.on("errorU",function(e){console.warn("error",e),"invalidAccessToken"===e.type&&(delete localStorage.accessToken,n.setState({accessToken:void 0}))}),n.io.on("connectUpdate",n.handleUpdateFromServer),n.io.on("update",n.handleUpdateFromServer),n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t={};["projects","breaks","defaultProjects","settings","startTime","endTime","productivityPercentages"].forEach(function(e){try{t[e]=JSON.parse(localStorage[e])}catch(n){t[e]=T.a[e]}}),["mode","defaultColorIndex","defaultColorIndexDefaultProjects","useDefaultProjects","lastReset","realEndTime"].forEach(function(e){t[e]=localStorage[e]?localStorage[e]:T.a[e]});for(var n=Object.keys(localStorage),a=0;a<n.length;a++){var r=n[a];if(r.startsWith("lastModified_")){for(var o=r.split("_"),i=o.length,s=t,c=0;c<i-1;c++)o[c]in s||(s[o[c]]={}),s=s[o[c]];s[o[i-1]]=new Date(localStorage[r])}}this.setState(t),function(t){setTimeout(function(){var n=localStorage.accessToken;n&&(e.io.disconnected?e.setState({accessToken:n}):e.io.emit("connectInit",{type:"accessToken",accessToken:n,localData:t}))},5)}.call(this,t)}},{key:"render",value:function(){var e=this.state,t=(e.accessToken,e.temp,e.lastModified,Object(m.a)(e,["accessToken","temp","lastModified"]));return r.a.createElement(J.MuiThemeProvider,{theme:t.settings.darkTheme?Fe:We},r.a.createElement("div",{style:{position:"relative"},onFocus:this.checkForUpdates,className:t.settings.darkTheme?"darkRoot":"lightRoot"},r.a.createElement(R.a,null),r.a.createElement(I,{data:t,connect:this.connect,update:this.update,disconnect:this.disconnect,loggedIn:Boolean(this.state.accessToken),disconnected:this.state.temp.disconnected,checkForUpdates:this.checkForUpdates}),r.a.createElement(C.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:this.state.temp.showDisconnectedError,autoHideDuration:6e3,onClose:this.closeSnackbar},r.a.createElement(x.a,{style:{backgroundColor:"#d32f2f"},"aria-describedby":"disconnectedErrorSnackbar",message:r.a.createElement("span",{id:"disconnectedErrorSnackbar"},"We're having trouble reaching our server"),action:[r.a.createElement(F.a,{key:"close","aria-label":"Close",color:"inherit",styles:{padding:".5rem"},onClick:this.closeSnackbar},r.a.createElement(B.a,null))]}))))}}]),t}(a.Component),Re=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Le(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}i.a.render(r.a.createElement(p,null,r.a.createElement(Ue,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("","/service-worker.js");Re?(function(e,t){fetch(e).then(function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):Le(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):Le(t,e)})}}()}},[[303,32,29]]]);
//# sourceMappingURL=main.80edbc7c.chunk.js.map